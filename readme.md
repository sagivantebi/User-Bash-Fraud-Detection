
# Fraud Detection - Bash Command History Masquerader Identification

## Overview

This project addresses the detection of masqueraders (imposters) based on bash command history segments from 40 users, each having 15,000 commands. The commands are segmented into groups of 100, resulting in 150 segments per user. The challenge is to identify the segments entered by a masquerader based on the patterns observed in the user's bash history.


<img src="https://github.com/user-attachments/assets/955ceb0e-940d-4f30-8d3f-63b954d91c4f" alt="frawd" width="250"/> 




## Data Pipeline

### 1. Data Exploration and Preprocessing
- **Command Segmentation:** We processed bash commands by segmenting them into groups of 100 commands per segment. The first 50 segments (5,000 commands) per user were utilized as the training set. The remaining 100 segments, which may contain commands from both genuine users and masqueraders, were also used for training and validation.
- **Labeling:** Commands were labeled as either genuine or masquerader based on predefined user behavior patterns.

### 2. Data Augmentation
- **Random Command Generation:** To diversify the training data and improve model generalization, random command segments were generated by sampling from the existing dataset.

### 3. Feature Engineering
- **Vectorization:** We utilized 'CountVectorizer' to convert the textual command data into numerical features by counting the occurrence of n-grams (word combinations) within a specific range. This vectorization allows the model to capture essential patterns in the sequence of commands.
- **N-grams (2 to 5):** N-grams help the model better understand the sequence and context of commands, which are critical for detecting masquerader behavior. The range of 2 to 5 n-grams captures dependencies between commands and helps identify unusual patterns that may be associated with masqueraders.

## Model Development

### 1. LSTM Autoencoder
We built an LSTM Autoencoder model to learn patterns in the command sequences. The model was trained to reconstruct command sequences, and segments with high reconstruction errors were flagged as potential masquerader activity. The LSTM architecture includes:
- 64 hidden layer units
- Dropout rate of 0.2
- Trained for 25 epochs
- Batch size: 32

### 2. Random Forest Classifier
A Random Forest model was trained on vectorized command segments to classify them as benign or masquerader segments. This model utilized:
- 2000 trees (estimators)
- Random state: 25

### 3. Threshold Calculation
The anomaly detection was refined by calculating thresholds for each user. These thresholds were based on the median and interquartile range (IQR) of the anomaly scores, with the threshold set at the median plus 1.5 times the IQR. This helps in identifying the most anomalous segments for further analysis.

## Evaluation

We evaluated the models using accuracy, F1, recall, and precision scores on a per-user basis. The performance of the models was assessed by dividing the dataset into training and validation sets across different users.

## Inference

During inference, for each user, we processed the test segments, predicted the probabilities using the Random Forest model, calculated user-specific vectors, and applied the learned thresholds to classify segments as either genuine or masquerader.

## File Structure

- **`FraudDetection.py`**: Main Python script containing the model training, evaluation, and prediction logic.
- **`FraudRawData/`**: Directory containing the bash command history data for all users.
- **`challengeToFill.csv`**: Output file where the predictions (0 for benign, 1 for masquerader) are written for each segment and user.
- **`description.docx`**: Documentation detailing the methodology and feature engineering techniques used.

## How to Run

1. Ensure you have all the necessary libraries installed. You can install the dependencies using:
    ```bash
    pip install -r requirements.txt
    ```

2. Download and extract the `FraudRawData.zip` file into the project directory.

3. Run the main Python script to train the model and generate predictions:
    ```bash
    python FraudDetection.py
    ```

4. The predictions will be written to `challengeToFill.csv`.

## Conclusion

This project demonstrates a comprehensive approach to detecting masqueraders in bash command histories using anomaly detection methods. By combining LSTM Autoencoders with Random Forest classifiers, we were able to create an effective fraud detection system that captures both command patterns and irregularities.
